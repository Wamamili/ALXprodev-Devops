#!/bin/bash
# Summarize PokÃ©mon data into CSV and compute averages

DIR="pokemon_data"
OUTFILE="pokemon_report.csv"

echo "Name,Height (m),Weight (kg)" > "$OUTFILE"

for FILE in "$DIR"/*.json; do
    NAME=$(jq -r '.name' "$FILE" | sed 's/.*/\u&/')
    HEIGHT=$(jq '.height' "$FILE")
    WEIGHT=$(jq '.weight' "$FILE")

    HEIGHT_M=$(awk -v h="$HEIGHT" 'BEGIN {printf "%.1f", h/10}')
    WEIGHT_KG=$(awk -v w="$WEIGHT" 'BEGIN {printf "%.1f", w/10}')

    echo "$NAME,$HEIGHT_M,$WEIGHT_KG" >> "$OUTFILE"
done

# Calculate averages
awk -F, 'NR>1 {sumH+=$2; sumW+=$3; count++} END {
    printf "\nAverage Height: %.2f m\nAverage Weight: %.2f kg\n", sumH/count, sumW/count
}' "$OUTFILE"

echo "CSV Report generated at: $OUTFILE"
